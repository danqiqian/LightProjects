# Controlling LED Strips

## What Kind of LED Strip Is This?
LED strips are easy to come by these days, and often you get them without documentation, or you lose the label. In those cases, it's easy to be confused about what you've got. Here are a few common things to look for:

* +12V/+24V
* R, G, B, A, W, WW, P
* VCC, DI, CI, DO, CO, GND - APA102
* G, DI, DO, arrow - WS2812

## Electrical and Physical Characteristics
* Channels
* Voltage
* Current
* Wattage
* Density
* Lumen output

## Constant Current sources

## Control lines: common anode or common cathode

## Transistors to Control LED Sources 

A lot of automotive and industrial LED lighting sources are "low voltage DC", meaning that they're lower than the 120V - 240V AC that you get out of a wall socket. You can control 12-24V DC sources with power transistors or MOSFETs from a microcontroller quite easily. The three models below work well for this purpose. 

Although the circuits below show how to control a 12V LED strip, the same circuit could be used to control any 12-24V DC LED source.

### TIP120 Darlington transistor
 These have been a staple in my projects for over two decades. [The TIP120](https://octopart.com/search?q=TIP120) transistor [(datasheet)](https://www.mccsemi.com/pdf/Products/TIP120(TO-220).pdf) is a bipolar transistor, designed for high current inductive loads like motors. Darlington transistors are actually two transistors in one, where the pairing of the two results in higher gain. The TIP120 has a built-in snubber diode to prevent damage from back-voltage generated by motors. You don't actually need these things for controlling LEDs, but what makes the TIP120 useful is that it can control a load up to 60V and 5A and it can be controlled reliably by either a 5V or 3.3V output from a microcontroller. 

 Figure 1 shows the wiring for a TIP120 Darlington transistor controlling a 12V DC LED source. The same circuit can be used for a 24V source, with a different power supply. 

![Figure 1. TIP120 transistor controlling an LED source](img/12VDC_LED_TIP120_circuit_bb.png)

_Figure 1. TIP120 transistor controlling an LED source._ 


If you're holding the TIP120 with the tab at the top and the bulk of the component facing you, then the pins, from left to right, are: base, collector, emitter. The base should be connected to a 1 kilohm resistor, and the other side of the resistor should be connected to the GPIO pin of the microcontroller that you plan to use to control the LEDs. The collector should be connected to the cathode of the LED source, and the emitter pin should be connected to ground. 

In Figure 1, the MKR Zero microcontroller is mounted as usual, straddling the center of a breadboard with its top pins plugged into row 1 of the board. The Vcc pin (physical pin 26) is connected to the breadboard's voltage bus as usual, and the ground pin (physical pin 25) is connected to the ground bus. The voltage and ground buses on either side of the board are connected to each other. Two TIP120 transistors are mounted in the right center section of the board below the MKR Zero, in rows 18-20 and 23-25, respectively. The MKR Zero's pins D4 and D5 (physical pins 13 and 14) are connected to 1 kilohm resistors, and the other ends of the resistors are connected to the bases of the transistors, in rows 18 and 23, resepective transistors' emitter pins, in rows 20 and 25, are both connected to ground. The transistors' collector pins are connected to the C and W connections of a 12V LED strip. The positive terminal of a DC power jack is connected to the +12V connection on the strip. The power jack's negative terminal is connected to the breadboard's ground bus. The jack should be connected to a +12V DC power supply. 

### FQP30N06L N-Channel MOSFET
A MOSFET (Metal Oxide Semiconductor Field-Effect Transistor) is a slightly more modern transistor, designed specifically for switching applications. Bipolar transistors draw a certain amount of current at the base to switch, while MOSFETs draw almost no current on their gate.  They're ideal for switching LED sources. They are more sensitive to electrostatic discharge than bipolar transistors, though, so you have to be more careful not to accidentally expose them to a static shock. Make sure you've grounded yourself well before working with MOSFETs. 

The [FQP30N06L](https://octopart.com/search?q=FQP30N06L) MOSFET [(datasheet)](https://cdn.sparkfun.com/datasheets/Components/General/FQP30N06L.pdf) is an N-channel MOSFET designed for switching high-speed circuits, and it's perfect for switching LEDs. It can control up to a 60V, 30A load and can be switched from 3.3V or 5V.

![Figure 2. FQP30N06L MOSFET controlling an LED source](img/12VDC_LED_MOSFET_circuit_bb.png)

_Figure 2. MKR Zero connected to a FQP30N06L MOSFET for controlling an LED source, in this case a strip of 12V warm white/cool white LEDs._ 

 Figure 2 shows the wiring for a MOSFET transistor controlling a 12V DC LED source. The same circuit can be used for a 24V source, with a different power supply. The wiring is similar to the TIP120 wiring, but the 1 kilohm resistors are omitted.

If you're holding the FQP30N06L MOSFET with the tab at the top and the bulk of the component facing you, then the pins, from left to right, are: gate, drain, source. The gate should be connected to the GPIO pin of the microcontroller that you plan to use to control the LEDs. The drain should be connected to the cathode of the LED source, and the source pin should be connected to ground. 

In Figure 2, the MKR Zero microcontroller is mounted as usual, straddling the center of a breadboard with its top pins plugged into row 1 of the board. The Vcc pin (physical pin 26) is connected to the breadboard's voltage bus as usual, and the ground pin (physical pin 25) is connected to the ground bus. The voltage and ground buses on either side of the board are connected to each other. Two FQP30N06L MOSFETs are mounted in the right center section of the board below the MKR Zero, in rows 18-20 and 23-25, respectively. The MKR Zero's pins D4 and D5 (physical pins 13 and 14) are connected to the gates of the MOSFETs, in rows 18 and 23, resepectively. THe MOSFETs' source pins, in rows 20 and 25, are both connected to ground. The MOSFETs' drain pins are connected to the C and W connections of a 12V LED strip. The positive terminal of a DC power jack is connected to the +12V connection on the strip. The power jack's negative terminal is connected to the breadboard's ground bus. The jack should be connected to a +12V DC power supply. 

### IRLB8721 N-Channel MOSFET

The [IRLB8721](https://octopart.com/search?q=IRLB8721) MOSFET [(datasheet)](https://www.infineon.com/dgdl/irlb8721pbf.pdf?fileId=5546d462533600a40153566056732591) is similar in specs to the FQP30N06L. It too can control up to a 60V, 30A load and can be switched from 3.3V or 5V. The pin configuration for this MOSFET is identical to the FQP30N06L, so Figure 2 above will work with this part in place of the previous MOSFET with no other change. 

## Controlling Multi-Channel LED Strips

Other than single-color LED strips or warm/cool strips, you may want to control RGB or RGBW or RGBAW (red, green, blue, amber, white), or some other variation. As long as the strip is not made of addressable LEDs, you can use variations on these same circuits. For example, if you've got a strip that's RGBW, you'd need four transistors, one for each channel. 


